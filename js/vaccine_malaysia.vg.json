{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "title": { "text": "The vaccination progress of Malaysia" },

    "data": {
    "url": "https://raw.githubusercontent.com/WongKangZhuang/Visualisation2/main/data/vax_malaysia_daily.csv"
    },
    "width": 800,
    "height": 800,
    "transform": [
        {
            "filter": 
            {
                "field": "date", 
                "range":[
                    {"year": 2021, "month": 2, "date": 24}, {"year": 2021, "month": 10, "date":1}
                ]
            }
        },
        {"calculate": "datum.cumul_partial/32655300 * 100", "as": "At least 1 dose"},
        {"calculate": "datum.cumul_full/32655300 * 100", "as": "Fully vaccinated"}

    ],
    "repeat": {
        "layer": ["At least 1 dose", "Fully vaccinated"]
    },
    
    "spec": {
        "mark": "area",
        "encoding": {            
            "x": {
                "field": "date",
                "type": "temporal"
            },
            "y": {
                "field": {"repeat": "layer"},
                "type": "quantitative"
            },
            "color": {
                "datum": {"repeat": "layer"},
                "type": "nominal"
            },
            "tooltip": [
                {"field": "date", "type": "temporal", "title": "Date"},
                {"field": "At least 1 dose", "type": "quantitative", "format": ".1f"},
                {"field": "Fully vaccinated", "type": "quantitative", "format": ".1f"}

            ]

        }
    }

   }